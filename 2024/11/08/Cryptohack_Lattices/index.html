<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Cryptohack - Lattices | Q1uJu's Blog</title><meta name="author" content="Q1uJu"><meta name="copyright" content="Q1uJu"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Cryptohack-LATTICESLATTICESVectors在某个域$$F$$上的一个向量空间$$V$$是用两个二元运算符定义的集合。 对于一个向量$$v\in{V}$$，和一个标量$$a\in{F}$$，向量的加法取两个向量并产生另一个向量：对于$$v,w,z\in{V}$$，$$v+w&#x3D;z$$，标量乘法取一个向量和一个标量，并产生一个向量：对于$$v,w\in{V},a\">
<meta property="og:type" content="article">
<meta property="og:title" content="Cryptohack - Lattices">
<meta property="og:url" content="http://q1uju.cc/2024/11/08/Cryptohack_Lattices/index.html">
<meta property="og:site_name" content="Q1uJu&#39;s Blog">
<meta property="og:description" content="Cryptohack-LATTICESLATTICESVectors在某个域$$F$$上的一个向量空间$$V$$是用两个二元运算符定义的集合。 对于一个向量$$v\in{V}$$，和一个标量$$a\in{F}$$，向量的加法取两个向量并产生另一个向量：对于$$v,w,z\in{V}$$，$$v+w&#x3D;z$$，标量乘法取一个向量和一个标量，并产生一个向量：对于$$v,w\in{V},a\">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://q1uju.cc/assets/background.png">
<meta property="article:published_time" content="2024-11-08T02:04:27.818Z">
<meta property="article:modified_time" content="2024-11-08T02:10:35.333Z">
<meta property="article:author" content="Q1uJu">
<meta property="article:tag" content="CTF-Crypto&#x2F;Misc">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://q1uju.cc/assets/background.png"><link rel="shortcut icon" href="/assets/favicon.ico"><link rel="canonical" href="http://q1uju.cc/2024/11/08/Cryptohack_Lattices/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        if (name && globalFn[key][name]) return
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: true,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Cryptohack - Lattices',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-11-08 10:10:35'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/assets/fac4.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">3</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/gallery/"><i class="fa-fw fas fa-images"></i><span> Galley</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/assets/background.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Q1uJu's Blog</span></a><a class="nav-page-title" href="/"><span class="site-name">Cryptohack - Lattices</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/gallery/"><i class="fa-fw fas fa-images"></i><span> Galley</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Cryptohack - Lattices</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label">Created</span><time datetime="2024-11-08T02:04:27.818Z" title="Created 2024-11-08 10:04:27">2024-11-08</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><meta name="referrer" content="no-referrer" />

<h1 id="Cryptohack-LATTICES"><a href="#Cryptohack-LATTICES" class="headerlink" title="Cryptohack-LATTICES"></a>Cryptohack-LATTICES</h1><h2 id="LATTICES"><a href="#LATTICES" class="headerlink" title="LATTICES"></a>LATTICES</h2><h3 id="Vectors"><a href="#Vectors" class="headerlink" title="Vectors"></a>Vectors</h3><p>在某个域$$F$$上的一个向量空间$$V$$是用两个二元运算符定义的集合。</p>
<p>对于一个向量$$v\in{V}$$，和一个标量$$a\in{F}$$，向量的加法取两个向量并产生另一个向量：对于$$v,w,z\in{V}$$，$$v+w&#x3D;z$$，标量乘法取一个向量和一个标量，并产生一个向量：对于$$v,w\in{V},a\in{F}$$，$$a·v&#x3D;w$$.</p>
<p>考虑实数域上的二维向量空间，一个向量$$v\in{V}$$被看作是一对数：对于$$a,b\in{R}$$，$$v&#x3D;(a,b)$$。向量加法以$$v+w&#x3D;(a,b)+(c,d)&#x3D;(a+c,b+d)$$的形式运算，标量乘法运算为$$c·v&#x3D;c·(a,b)&#x3D;(c·a,c·b)$$.</p>
<p>还可以定义内积（也称为点积），它取两个向量并返回一个标量。从形式上讲，我们认为：对于$$v,w\in{V},a\in{F}$$，$$v·w&#x3D;a$$。在我们的二维例子中，内积运算为：$$v·w&#x3D;(a,b)·(c,d)&#x3D;a·c+b·d$$.</p>
<p>题目：</p>
<p>给出以下三个向量<code>v = (2,6,3)</code>，<code>w = (1,0,0)</code>，<code>u = (7,7,2)</code>，计算<code>3*(2*v - w) · 2*u</code>。</p>
<p>考察：基本的向量与标量之间的运算</p>
<p>直接计算或使用SageMath计算：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">v = vector([2,6,3])</span><br><span class="line">w = vector([1,0,0])</span><br><span class="line">u = vector([7,7,2])</span><br><span class="line">3*(2*v - w)*2*u</span><br><span class="line"># 702</span><br></pre></td></tr></table></figure>

<h3 id="Size-and-Basis"><a href="#Size-and-Basis" class="headerlink" title="Size and Basis"></a>Size and Basis</h3><p>一组向量$$v_1,v_2…v_k\in{V}$$是线性无关的，当且仅当<br>$$<br>a_1v_1+a_2v_2+…+a_kv_k&#x3D;0<br>$$<br>仅在$$a_1&#x3D;a_2&#x3D;…&#x3D;a_k&#x3D;0$$时成立</p>
<p>基是一组线性独立的向量$$v_1,v_2,…,v_n\in{V}$$使得任何向量$$w\in{V}$$可以写成：<br>$$<br>w&#x3D;a_1·v_1+a_2·v_2+…+a_k·v_n<br>$$</p>
<p><code>基中的元素数量</code>是<code>向量空间的维数</code></p>
<p>向量的大小，定义为<code>||v||</code>，向量自己和自己做内积：$$||v||^2&#x3D;v·v$$</p>
<p>一组<code>正交基(orthogonal)</code>是指一组向量基$$v_1,v_2,…,v_n\in{V}$$，其两两不同的向量之间内积为0：$$v_i·v_j&#x3D;0,i\neq{j}$$.</p>
<p>一组<code>标准正交基(orthonormal)</code>是指一组正交基，对于所有$$i$$，其大小$$||v_i||&#x3D;1$$.</p>
<p>题目：</p>
<p>给出一个向量<code>v=(4,6,2,5)</code>，计算它的大小。</p>
<p>考察：求向量的大小或者说向量的模</p>
<p>直接计算或使用SageMath计算：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">v = vector([4,6,2,5])</span><br><span class="line">norm(v)</span><br><span class="line"># 9</span><br></pre></td></tr></table></figure>

<h3 id="Gram-Schmidt"><a href="#Gram-Schmidt" class="headerlink" title="Gram Schmidt"></a>Gram Schmidt</h3><p>给出一组向量空间的基$$v_1,v_2,…,v_n\in{V}$$，格拉姆-施密特算法可以计算这个向量空间的一组正交基$$u_1,u_2,…,u_n\in{V}$$.</p>
<p>在Jeffrey Hoffstein、Jill Pipher、Joseph H.Silverman所著的《数学密码学导论》中，格拉姆-施密特算法如下：</p>
<blockquote>
<p>格拉姆-施密特算法</p>
<p>$$u_1&#x3D;v_1$$</p>
<p>Loop $$i$$ &#x3D; 2,3…,n</p>
<p>​    Compute $$\mu_{ij}&#x3D;v_i·u_j&#x2F;||u_j||^2,1\leq{j}&lt;i$$.</p>
<p>​    Set $$u_i&#x3D;v_i-\mu_{ij}·u_j$$(Sum over $$j$$ for $$1\leq{j}&lt;i$$)</p>
<p>End Loop</p>
</blockquote>
<p>题目：</p>
<p>给出以下一组基向量：<br>$$<br>v_1&#x3D;(4,1,3,-1),v_2&#x3D;(2,1,-3,4),v_3&#x3D;(1,0,-2,7),v_4&#x3D;(6,2,9,-5)<br>$$<br>使用格拉姆-施密特算法计算正交基。flag是$$u_4$$的第二个成员的浮点数值，保留小数点后五位。</p>
<p>考察：格拉姆-施密特算法计算正交基</p>
<p>使用SageMath计算：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">v0 = vector([4,1,3,-1])</span><br><span class="line">v1 = vector([2,1,-3,4])</span><br><span class="line">v2 = vector([1,0,-2,7])</span><br><span class="line">v3 = vector([6,2,9,-5])</span><br><span class="line">M = Matrix([v0,v1,v2,v3])</span><br><span class="line">M_GS = M.gram_schmidt()</span><br><span class="line">round(M_GS[0][3][1],5)</span><br><span class="line"># 0.91611</span><br></pre></td></tr></table></figure>

<p>贴一个Python的Solution：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">v = [</span><br><span class="line">    np.array([<span class="number">4</span>,<span class="number">1</span>,<span class="number">3</span>,-<span class="number">1</span>]),</span><br><span class="line">    np.array([<span class="number">2</span>,<span class="number">1</span>,-<span class="number">3</span>,<span class="number">4</span>]),</span><br><span class="line">    np.array([<span class="number">1</span>,<span class="number">0</span>,-<span class="number">2</span>,<span class="number">7</span>]),</span><br><span class="line">    np.array([<span class="number">6</span>,<span class="number">2</span>,<span class="number">9</span>,-<span class="number">5</span>])</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">u1 = v1</span></span><br><span class="line"><span class="string">Loop i = 2,3...,n</span></span><br><span class="line"><span class="string">   Compute μij = vi ∙ uj / ||uj||2, 1 ≤ j &lt; i.</span></span><br><span class="line"><span class="string">   Set ui = vi - μij * uj (Sum over j for 1 ≤ j &lt; i)</span></span><br><span class="line"><span class="string">End Loop</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">u = [v[<span class="number">0</span>]]</span><br><span class="line"><span class="keyword">for</span> vi <span class="keyword">in</span> v[<span class="number">1</span>:]:</span><br><span class="line">    mi = [np.dot(vi, uj) / np.dot(uj,uj) <span class="keyword">for</span> uj <span class="keyword">in</span> u]</span><br><span class="line">    u += [vi - <span class="built_in">sum</span>([mij * uj <span class="keyword">for</span> (mij, uj) <span class="keyword">in</span> <span class="built_in">zip</span>(mi,u)])]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">round</span>(u[<span class="number">3</span>][<span class="number">1</span>], <span class="number">5</span>))</span><br></pre></td></tr></table></figure>

<h3 id="What’s-a-Lattice"><a href="#What’s-a-Lattice" class="headerlink" title="What’s a Lattice?"></a>What’s a Lattice?</h3><p>给出一组线性无关的向量$$v_1,v_2,…,v_n\in{R^m}$$，由$$v_1,v_2,…,v_n$$生成的格子$$L$$是由$$v_1,v_2,…,v_n$$和对应整系数的组合。<br>$$<br>L&#x3D;a_1·v_1+a_2·v_2+…+a_k·v_k:a_1,a_2,…,a_n\in{\mathbb{Z}}<br>$$<br>格$$L$$的基，可以是任意一组生成L的线性无关的向量。基的选择不唯一。在下图中，展示了一个由两组不同的基向量$$u_1,u_2$$和$$v_1,v_2$$生成的二维格。</p>
<p><img src="https://gitee.com/Q1uJu/picture_bed/raw/master/image-20241104210111547.png" alt="image-20241104210111547"></p>
<p>使用基向量，我们可以用基向量的整数倍乘来到达格内的任意一点。基向量还定义了基本域：<br>$$<br>F(v_1,…,v_n)&#x3D;t_1<em>v_1+t_2</em>v_2+…+t_n*v_n:0\leq{t_i}&lt;1.<br>$$<br>举一个二维的例子，基本域是由边$$u_1$$和$$u_2$$构成的平行四边形。</p>
<p>我们可以通过基向量计算基本域的体积。例如，取一个以$$v&#x3D;(2,5),u&#x3D;(3,1)$$为基向量的二维格。创建一个矩阵$$A$$，其行对应于基向量：$$A&#x3D;[[2,5],[3,1]]$$。这个基本域的体积为矩阵$$A$$行列式的大小：$$vol(F)&#x3D;|det(A)|&#x3D;|2·1-5·3|&#x3D;|-13|&#x3D;13$$.</p>
<p>题目：</p>
<p>计算由基向量$$v_1&#x3D;(6,2,-3),v_2&#x3D;(5,1,4),v_3&#x3D;(2,7,1)$$构成的基本域的体积。</p>
<p>考察：基向量构成的基本域的体积</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">v = vector</span><br><span class="line">v1 = v([6,2,-3])</span><br><span class="line">v2 = v([5,1,4])</span><br><span class="line">v3 = v([2,7,1])</span><br><span class="line">A = matrix([v1,v2,v3])</span><br><span class="line">det(A)</span><br></pre></td></tr></table></figure>

<h3 id="Gaussian-Reduction"><a href="#Gaussian-Reduction" class="headerlink" title="Gaussian Reduction"></a>Gaussian Reduction</h3><p>如果你仔细观察，格密码开始在密码学中无处不在。有时，它们通过操纵加密系统出现，破坏了不够安全地生成的参数。最著名的例子是Coppersmith对RSA密码学的攻击。</p>
<p>格密码也可用于构建加密协议，其安全性基于两个基本的困难问题：</p>
<p><strong>最短向量问题（SVP）</strong>：在格L中找到最短的非零向量。换句话说，在$$v\in{L}$$内找到非零向量，使$$||v||$$取最小值。</p>
<p><strong>最近向量问题（CVP）</strong>：给定一个不在L中的向量$$w\in{R_m}$$，找到与$$w$$最接近的向量$$v\in{L}$$，即找到向量$$v\in{L}$$，使$$||v-w||$$取最小值。</p>
<p>对于一般格来说，SVP很难，但对于足够简单的情况，有有效的算法来计算SVP的解或近似值。当格的维数为4或更小时，我们可以在多项式时间内精确计算；对于更高的维度，我们不得不接受一个近似值。</p>
<p>高斯开发了他的算法，为给定任意基的二维格找到最优基。此外，该算法的输出$$v_1$$是$$L$$中最短的非零向量，因此求解了SVP。</p>
<blockquote>
<p>ps:对于更高维度，有一种称为LLL算法的格基约减算法，以Lenstra、Lenstra和Lovász的名字命名。如果你经常玩CTF，你就一定会知道。LLL算法在多项式时间内运行。不过，就目前而言，让我们停留在二维空间。</p>
</blockquote>
<p>高斯的算法大致通过从另一个基向量中减去一个基向量的倍数来工作，直到不再可能使它们更小。由于这是在二维中工作的，因此很容易可视化。以下是Jeffrey Hoffstein、Jill Pipher和Joseph H.Silverman在《数学密码学导论》中对算法的描述：</p>
<blockquote>
<p>高斯格约化算法</p>
<p>Loop</p>
<p>​    (a) If $$||v_2||&lt; ||v_1||$$, swap $$v_1,v_2$$</p>
<p>​    (b) Compute $$m&#x3D;[v_1·v_2&#x2F;v_1·v_1]$$</p>
<p>​    (c) If $$m&#x3D;0$$, return $$v_1,v_2$$</p>
<p>​    (d) $$v_2&#x3D;v_2-m·v_1$$</p>
<p>Continue Loop</p>
</blockquote>
<p>请注意，与欧几里德的GCD算法在“交换”和“缩减”步骤上的相似性，我们必须对浮点数进行四舍五入，因为在格上，我们可能只使用整数作为基向量的系数。</p>
<p>题目：</p>
<p>取两个向量$$v&#x3D;(846835985,9834798552),u&#x3D;(87502093,123094980)$$，通过高斯算法，找到最优基，flag为新的基向量的内积。</p>
<p>考察：高斯格约化算法求最优基</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">v = vector([846835985, 9834798552])</span><br><span class="line">u = vector([87502093, 123094980])</span><br><span class="line">v1,v2 = u,v</span><br><span class="line">m = 1</span><br><span class="line">while m != 0:</span><br><span class="line">    if norm(v2) &lt; norm(v1):</span><br><span class="line">        print(&#x27;swap&#x27;)</span><br><span class="line">        v1,v2 = v2,v1</span><br><span class="line">    m = int((v1*v2)/(v1*v1))</span><br><span class="line">    v2 = v2 - m*v1</span><br><span class="line">print(v1, v2)</span><br><span class="line">print(v1*v2)</span><br></pre></td></tr></table></figure>

<h3 id="Find-the-Lattice"><a href="#Find-the-Lattice" class="headerlink" title="Find the Lattice"></a>Find the Lattice</h3><p>正如我们所看到的，格包含一些难题，这些难题可以形成密码系统的陷门函数。我们还发现，在密码分析中，格可以破坏最初似乎与格无关的密码协议。</p>
<p>这个挑战使用模块化算法来加密标志，但协议中隐藏着一个二维格。我们强烈建议花时间应对这一挑战，并找到如何用格子打破它。这是一个著名的例子，有很多可用的资源，但知道如何在系统中发现格通常是打破它的关键。</p>
<p>作为提示，您将能够使用前一个挑战的高斯缩减来完成这个挑战。</p>
<p>题目代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, inverse, bytes_to_long</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line">FLAG = <span class="string">b&#x27;crypto&#123;?????????????????????&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_key</span>():</span><br><span class="line">    q = getPrime(<span class="number">512</span>)</span><br><span class="line">    upper_bound = <span class="built_in">int</span>(math.sqrt(q // <span class="number">2</span>))</span><br><span class="line">    lower_bound = <span class="built_in">int</span>(math.sqrt(q // <span class="number">4</span>))</span><br><span class="line">    f = random.randint(<span class="number">2</span>, upper_bound)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        g = random.randint(lower_bound, upper_bound)</span><br><span class="line">        <span class="keyword">if</span> math.gcd(f, g) == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    h = (inverse(f, q)*g) % q</span><br><span class="line">    <span class="keyword">return</span> (q, h), (f, g)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">q, h, m</span>):</span><br><span class="line">    <span class="keyword">assert</span> m &lt; <span class="built_in">int</span>(math.sqrt(q // <span class="number">2</span>))</span><br><span class="line">    r = random.randint(<span class="number">2</span>, <span class="built_in">int</span>(math.sqrt(q // <span class="number">2</span>)))</span><br><span class="line">    e = (r*h + m) % q</span><br><span class="line">    <span class="keyword">return</span> e</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">q, h, f, g, e</span>):</span><br><span class="line">    a = (f*e) % q</span><br><span class="line">    m = (a*inverse(f, g)) % g</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">public, private = gen_key()</span><br><span class="line">q, h = public</span><br><span class="line">f, g = private</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(FLAG)</span><br><span class="line">e = encrypt(q, h, m)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;Public key: <span class="subst">&#123;(q,h)&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;Encrypted Flag: <span class="subst">&#123;e&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>题目输出：</p>
<blockquote>
<p>Public key: (7638232120454925879231554234011842347641017888219021175304217358715878636183252433454896490677496516149889316745664606749499241420160898019203925115292257, 2163268902194560093843693572170199707501787797497998463462129592239973581462651622978282637513865274199374452805292639586264791317439029535926401109074800)<br>Encrypted Flag: 5605696495253720664142881956908624307570671858477482119657436163663663844731169035682344974286379049123733356009125671924280312532755241162267269123486523</p>
</blockquote>
<p>已知q, h, e，其中<br>$$<br>h\equiv{f^{-1}<em>g}\mod{q}\<br>e\equiv{(r</em>h+m})\mod{q}<br>$$</p>
<blockquote>
<p>q 512位</p>
<p>f,g 低于256位</p>
<p>h,e 512位</p>
<p>r 256位</p>
<p>m为flag，大小约为231bit</p>
</blockquote>
<p>要求得m，需要获得<code>decrypt</code>的参数，还剩$$f$$和$$g$$是未知的，由(6)式中可知<br>$$<br>f·h\equiv g\mod q<br>$$<br>用上一题格的思想，构造一个由下面这个矩阵$$M$$的两个行向量$$(1,h),(0,q)$$所张成的Lattice：<br>$$<br>M &#x3D; \begin{bmatrix}<br>    1 &amp; h \<br>    0 &amp; q<br>\end{bmatrix} \tag{1}<br>$$<br>向量$$(f,g)$$在这个格上，即存在系数$$a,b$$使$$a(1,h)+b(0,q)&#x3D;(f,g)$$<br>$$<br>f·h \equiv g \mod q\<br>f·h &#x3D; g + u·q\<br>f·h - u·q &#x3D; g<br>$$<br>即$$a,b&#x3D;f,-u$$满足条件</p>
<p>向量$$(f,g)$$可以由两组基向量$$M$$的某种整系数线性组合$$(f,-u)$$来表示，因此向量$$(f,g)$$就在这个Lattice上。</p>
<p>对于两个基底向量，(1,h):512位,(0,q):512位</p>
<p>而向量$$(f,g)$$的长度约为256位，相比于基底向量极小，很大概率为此Lattice的最短向量。</p>
<p>EXP(SageMath):</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># Gauss Lattice Reduction</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Gauss</span>(<span class="params">v1, v2</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">if</span> norm(v2) &lt; norm(v1):</span><br><span class="line">            v1, v2 = v2, v1</span><br><span class="line">        m = <span class="built_in">round</span>( v1*v2 / norm(v1)^<span class="number">2</span> )</span><br><span class="line">        <span class="keyword">if</span> m == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> (v1, v2)</span><br><span class="line">        v2 = v2 - m*v1</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">q, h, f, g, e</span>):</span><br><span class="line">    a = (f*e) % q</span><br><span class="line">    m = (a*inverse(f, g)) % g</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line">        </span><br><span class="line">q, h = (<span class="number">7638232120454925879231554234011842347641017888219021175304217358715878636183252433454896490677496516149889316745664606749499241420160898019203925115292257</span>, <span class="number">2163268902194560093843693572170199707501787797497998463462129592239973581462651622978282637513865274199374452805292639586264791317439029535926401109074800</span>)</span><br><span class="line">e = <span class="number">5605696495253720664142881956908624307570671858477482119657436163663663844731169035682344974286379049123733356009125671924280312532755241162267269123486523</span></span><br><span class="line">v = vector([<span class="number">1</span>, h])</span><br><span class="line">u = vector([<span class="number">0</span>, q])</span><br><span class="line">Gauss(v, u)</span><br><span class="line"><span class="comment"># ((47251817614431369468151088301948722761694622606220578981561236563325808178756, 43997957885147078115851147456370880089696256470389782348293341937915504254589),</span></span><br><span class="line"><span class="comment"># (-67269010250212717075432182693043963184097648880165008621907831284647116025901, 99012763459529858809608436133564630524350106000242070336818304053467942269178))</span></span><br><span class="line">f, g = (<span class="number">47251817614431369468151088301948722761694622606220578981561236563325808178756</span>, <span class="number">43997957885147078115851147456370880089696256470389782348293341937915504254589</span>)</span><br><span class="line">m = decrypt(q, h, f, g, e)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment"># b&#x27;crypto&#123;Gauss_lattice_attack!&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="http://q1uju.cc">Q1uJu</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="http://q1uju.cc/2024/11/08/Cryptohack_Lattices/">http://q1uju.cc/2024/11/08/Cryptohack_Lattices/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-share"><div class="social-share" data-image="/assets/background.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/assets/fac4.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Q1uJu</div><div class="author-info-description">Learning Record</div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">3</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Q1uJu"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/Q1uJu" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:1613732401@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Cryptohack-LATTICES"><span class="toc-number">1.</span> <span class="toc-text">Cryptohack-LATTICES</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#LATTICES"><span class="toc-number">1.1.</span> <span class="toc-text">LATTICES</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Vectors"><span class="toc-number">1.1.1.</span> <span class="toc-text">Vectors</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Size-and-Basis"><span class="toc-number">1.1.2.</span> <span class="toc-text">Size and Basis</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Gram-Schmidt"><span class="toc-number">1.1.3.</span> <span class="toc-text">Gram Schmidt</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#What%E2%80%99s-a-Lattice"><span class="toc-number">1.1.4.</span> <span class="toc-text">What’s a Lattice?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Gaussian-Reduction"><span class="toc-number">1.1.5.</span> <span class="toc-text">Gaussian Reduction</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Find-the-Lattice"><span class="toc-number">1.1.6.</span> <span class="toc-text">Find the Lattice</span></a></li></ol></li></ol></li></ol></div></div></div></div></main><footer id="footer" style="background-image: url(/assets/footer.png);"><div id="footer-wrap"><div class="copyright">&copy;2024 By Q1uJu</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">There will be fog lights in the mountains.</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><script>(() => {
  const loadMathjax = () => {
    if (!window.MathJax) {
      window.MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']],
          tags: 'none',
        },
        chtml: {
          scale: 1.1
        },
        options: {
          enableMenu: true,
          renderActions: {
            findScript: [10, doc => {
              for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
                const display = !!node.type.match(/; *mode=display/)
                const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
                const text = document.createTextNode('')
                node.parentNode.replaceChild(text, node)
                math.start = {node: text, delim: '', n: 0}
                math.end = {node: text, delim: '', n: 0}
                doc.math.push(math)
              }
            }, '']
          }
        }
      }
      
      const script = document.createElement('script')
      script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
      script.id = 'MathJax-script'
      script.async = true
      document.head.appendChild(script)
    } else {
      MathJax.startup.document.state(0)
      MathJax.texReset()
      MathJax.typesetPromise()
    }
  }

  btf.addGlobalFn('encrypt', loadMathjax, 'mathjax')
  window.pjax ? loadMathjax() : window.addEventListener('load', loadMathjax)
})()</script></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="false"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>